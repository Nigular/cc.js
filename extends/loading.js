"use strict";var cc=window.cc||{};cc.Loading={init:function(m){var e,t,o=this;if(m.searchImgs=void 0===m.searchImgs||m.searchImgs,o.imgs1=m.imgs||[],o.imgs2=[],o.imgs3=[],o.imgDoms=[],o.bgDoms=[],o.imgList=[[],[],[]],o.callback=m.callback,o.enterCallback=m.enterCallback,o.count=0,document.body.offsetHeight,m.searchImgs&&function(){for(var e,t,s,a=m.searchImgs.type||"src",g=0,r=(e=m.searchImgs.dom?m.searchImgs.dom.getElementsByTagName("img"):document.images).length;g<r;)t=void 0,t=e[g],(s=t.getAttribute("data-"+a))&&(t.removeAttribute("data-"+a),o.imgDoms.push(t),o.imgs2.push(s)),g++}(),m.searchBgs)for(var s,a=m.searchBgs.type||"bg",g=0,r=(s=m.searchBgs.dom?m.searchBgs.dom.getElementsByTagName("*"):document.getElementsByTagName("*")).length;g<r;)e=void 0,e=s[g],(t=e.getAttribute("data-"+a))&&(e.removeAttribute("data-"+a),o.bgDoms.push(e),o.imgs3.push(t)),g++;o.length=o.imgs1.length+o.imgs2.length+o.imgs3.length,0<o.length?(o.loadImgs(o.imgs1,0),o.loadImgs(o.imgs2,1),o.loadImgs(o.imgs3,2)):m.callback&&m.callback()},loadImgs:function(e,t){for(var s=0,a=e.length;s<a;s++)this.loadImage(e[s],t,s)},loadImage:function(e,t,s){var a,g=this;switch(t){case 0:a=new Image,g.imgList[t].push(a),a.src=e;break;case 1:a=g.imgDoms[s],g.imgList[t].push(a),a.src=e;break;case 2:(a=new Image).src=e,g.imgList[t].push(a),g.bgDoms[s].style.backgroundImage="url("+e+")"}a.errorCount=0,a.complete?g.enter():(a.onload=function(){a.onload=null,g.enter()},a.onerror=function(){a.errorCount++,10<a.errorCount?(a.onerror=null,alert("有图片加载失败,"+e),g.enter()):(a.src=e,2==t&&(g.bgDoms[s].style.backgroundImage="url("+e+")"))})},enter:function(){var e=this;e.count++,e.enterCallback&&e.enterCallback(),e.count==e.length&&e.callback&&(document.body.offsetHeight,e.callback())}};